{
  "src": {
    "components": {
      "admin": {
        "WineTable": {
          "components": {
            "EmptyState.tsx": "import { Wine as WineIcon } from \"lucide-react\"\r\n\r\ninterface EmptyStateProps {\r\n  searchTerm: string\r\n  totalWines: number\r\n}\r\n\r\nexport function EmptyState({ searchTerm, totalWines }: EmptyStateProps) {\r\n  return (\r\n    <div className=\"text-center py-12 bg-white rounded-2xl shadow-xl border border-red-100\">\r\n      <WineIcon className=\"h-16 w-16 text-gray-400 mx-auto mb-4\" />\r\n      <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n        {searchTerm ? \"No se encontraron vinos\" : \"No hay vinos en el inventario\"}\r\n      </h3>\r\n      <p className=\"text-gray-500\">\r\n        {searchTerm\r\n          ? `No hay vinos que coincidan con \"${searchTerm}\"`\r\n          : \"Importa un archivo Excel para comenzar\"\r\n        }\r\n      </p>\r\n    </div>\r\n  )\r\n}\r\n",
            "WinePagination.tsx": "import { ChevronLeft, ChevronRight } from \"lucide-react\"\r\nimport { Button } from \"@/components/ui/button\"\r\n\r\ninterface WinePaginationProps {\r\n  currentPage: number\r\n  totalPages: number\r\n  startIndex: number\r\n  endIndex: number\r\n  totalItems: number\r\n  pageNumbers: (number | 'ellipsis')[]\r\n  onPageChange: (page: number) => void\r\n  onNext: () => void\r\n  onPrev: () => void\r\n  hasNextPage: boolean\r\n  hasPrevPage: boolean\r\n}\r\n\r\nexport function WinePagination({\r\n  currentPage,\r\n  totalPages,\r\n  startIndex,\r\n  endIndex,\r\n  totalItems,\r\n  pageNumbers,\r\n  onPageChange,\r\n  onNext,\r\n  onPrev,\r\n  hasNextPage,\r\n  hasPrevPage,\r\n}: WinePaginationProps) {\r\n  if (totalPages <= 1) return null\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-between px-6 py-4 bg-white border-t border-gray-200 mt-2 rounded-2xl\">\r\n      <div className=\"text-sm text-gray-700\">\r\n        Mostrando {startIndex + 1} a {Math.min(endIndex, totalItems)} de {totalItems} vinos\r\n      </div>\r\n\r\n      <div className=\"flex items-center gap-2\">\r\n        <Button\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          onClick={onPrev}\r\n          disabled={!hasPrevPage}\r\n          className=\"flex items-center gap-1\"\r\n        >\r\n          <ChevronLeft className=\"h-4 w-4\" />\r\n          Anterior\r\n        </Button>\r\n\r\n        <div className=\"flex items-center gap-1\">\r\n          {pageNumbers.map((page, index) => (\r\n            <div key={index}>\r\n              {page === 'ellipsis' ? (\r\n                <span className=\"flex h-9 w-9 items-center justify-center text-sm text-gray-500\">\r\n                  ...\r\n                </span>\r\n              ) : (\r\n                <Button\r\n                  variant={currentPage === page ? \"default\" : \"outline\"}\r\n                  className={`h-9 w-9 p-0 font-bold ${currentPage === page\r\n                      ? 'bg-primary hover:bg-primary/90'\r\n                      : 'border-primary/10 text-primary hover:bg-primary/5'\r\n                    }`}\r\n                  size=\"sm\"\r\n                  onClick={() => onPageChange(page as number)}\r\n                >\r\n                  {page}\r\n                </Button>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        <Button\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          onClick={onNext}\r\n          disabled={!hasNextPage}\r\n          className=\"flex items-center gap-1\"\r\n        >\r\n          Siguiente\r\n          <ChevronRight className=\"h-4 w-4\" />\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n",
            "WineRow.tsx": "import { Wine } from \"@/types\"\r\nimport { SquarePen, Trash2 } from \"lucide-react\"\r\nimport EditWineModal from \"@/components/admin/edit-wine-modal\"\r\nimport DeleteWineModal from \"@/components/admin/delete-wine-modal\"\r\nimport { formatPrice } from \"../utils/formatPrice\"\r\nimport { getColorBadge } from \"../utils/getColorBadge\"\r\n\r\ninterface WineRowProps {\r\n  wine: Wine\r\n  index: number\r\n}\r\n\r\nexport function WineRow({ wine, index }: WineRowProps) {\r\n  const rowBgClass = index % 2 === 0 ? 'bg-white' : 'bg-gray-50'\r\n\r\n  return (\r\n    <tr className={rowBgClass}>\r\n      {/* Sticky First Column */}\r\n      <td className={`sticky left-0 z-20 px-6 py-4 border-r border-gray-200 w-72 min-w-72 max-w-72 shadow-lg ${rowBgClass}`}>\r\n        <div className=\"flex items-center gap-4\">\r\n          {wine.url_imagen && (\r\n            <img\r\n              src={wine.url_imagen}\r\n              alt={wine.nombre}\r\n              className=\"w-16 h-16 rounded-lg object-cover shadow-sm border border-gray-200 flex-shrink-0\"\r\n            />\r\n          )}\r\n          <div className=\"min-w-0 flex-1\">\r\n            <div className=\"font-semibold text-gray-900 text-sm leading-tight truncate\">\r\n              {wine.nombre}\r\n            </div>\r\n            <div className=\"text-sm text-gray-500 mt-1 truncate\">\r\n              {wine.pais_importacion} • {wine.variedades.length > 0 ? wine.variedades.join(', ') : ''}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </td>\r\n\r\n      {/* Scrollable Middle Columns */}\r\n      <td className=\"px-6 py-4 text-center\">\r\n        <span className={`inline-flex px-3 py-1 rounded-full text-sm font-semibold ${wine.stock > 20 ? 'bg-green-100 text-green-800' :\r\n            wine.stock > 10 ? 'bg-yellow-100 text-yellow-800' :\r\n              'bg-red-100 text-red-800'\r\n          }`}>\r\n          {wine.stock} unidades\r\n        </span>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4 text-start\">\r\n        <span className=\"font-semibold text-gray-900 text-lg\">\r\n          {formatPrice(wine.precio)}\r\n        </span>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4 text-center\">\r\n        <span className=\"font-semibold text-gray-900 text-lg\">\r\n          {wine.wine_details.tipo_crianza}\r\n        </span>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4 text-center\">\r\n        <span className=\"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium\">\r\n          {wine.nivel_alcohol}%\r\n        </span>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4 text-center\">\r\n        <span className={`inline-flex px-3 py-1 rounded-full text-sm font-medium border ${getColorBadge(wine.color_vino)}`}>\r\n          {wine.color_vino}\r\n        </span>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4\">\r\n        <div className=\"flex flex-wrap gap-1 justify-center\">\r\n          {wine.variedades.map((variedad: string, idx: number) => (\r\n            <span\r\n              key={idx}\r\n              className=\"bg-purple-100 text-purple-800 px-2 py-1 rounded-md text-xs font-medium whitespace-nowrap\"\r\n            >\r\n              {variedad}\r\n            </span>\r\n          ))}\r\n        </div>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4 text-center\">\r\n        {wine.wine_details.bodega}\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4\">\r\n        <p className=\"text-gray-600 text-sm leading-relaxed\">\r\n          {wine.wine_details.notas_cata}\r\n        </p>\r\n      </td>\r\n\r\n      <td className=\"px-6 py-4 text-center\">\r\n        <span className=\"font-semibold text-gray-900 text-lg\">\r\n          {wine.capacidad}\r\n        </span>\r\n      </td>\r\n\r\n      {/* Sticky Last Column */}\r\n      <td className={`sticky right-0 z-20 px-6 py-4 border-l border-gray-200 w-32 min-w-32 max-w-32 shadow-lg ${rowBgClass}`}>\r\n        <div className=\"flex items-center justify-center gap-2 w-full\">\r\n          <EditWineModal vino={wine}>\r\n            <div className=\"bg-primary/10 hover:bg-primary hover:text-white text-primary p-2 h-8 w-8 rounded-lg flex items-center justify-center cursor-pointer transition-all border border-primary/20\">\r\n              <SquarePen size={14} />\r\n            </div>\r\n          </EditWineModal>\r\n          <DeleteWineModal vino={wine}>\r\n            <div className=\"bg-destructive/10 hover:bg-destructive hover:text-white text-destructive p-2 h-8 w-8 rounded-lg flex items-center justify-center cursor-pointer transition-all border border-destructive/20\">\r\n              <Trash2 size={14} />\r\n            </div>\r\n          </DeleteWineModal>\r\n        </div>\r\n      </td>\r\n    </tr>\r\n  )\r\n}\r\n",
            "WineSearch.tsx": "import { Search } from \"lucide-react\"\r\nimport { Input } from \"@/components/ui/input\"\r\n\r\ninterface WineSearchProps {\r\n  searchTerm: string\r\n  onSearchChange: (value: string) => void\r\n  onClear: () => void\r\n  totalWines: number\r\n  filteredCount: number\r\n}\r\n\r\nexport function WineSearch({\r\n  searchTerm,\r\n  onSearchChange,\r\n  onClear,\r\n  totalWines,\r\n  filteredCount\r\n}: WineSearchProps) {\r\n  return (\r\n    <div className=\"px-6 pb-4 flex flex-col items-center\">\r\n      <div className=\"relative max-w-xl w-full\">\r\n        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n          <Search className=\"h-5 w-5 text-gray-400\" />\r\n        </div>\r\n        <Input\r\n          type=\"text\"\r\n          placeholder=\"Buscar vino por nombre...\"\r\n          value={searchTerm}\r\n          onChange={(e) => onSearchChange(e.target.value)}\r\n          className=\"pl-10 pr-4 py-2 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-all duration-200 focus-visible:ring-0 focus-visible:ring-offset-0\"\r\n        />\r\n        {searchTerm && (\r\n          <button\r\n            onClick={onClear}\r\n            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600\"\r\n          >\r\n            <span className=\"text-lg\">×</span>\r\n          </button>\r\n        )}\r\n      </div>\r\n      {searchTerm && (\r\n        <p className=\"text-sm text-gray-600 mt-2\">\r\n          Mostrando {filteredCount} de {totalWines} vinos\r\n        </p>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n",
            "WineTableBody.tsx": "import { Wine } from \"@/types\"\r\nimport { WineRow } from \"./WineRow\"\r\nimport {\r\n  Wine as WineIcon,\r\n  Icon,\r\n  DollarSign,\r\n  Clock,\r\n  Percent,\r\n  Palette,\r\n  Grape,\r\n  MapPin,\r\n  StickyNote\r\n} from \"lucide-react\"\r\nimport { wineGlassBottle } from '@lucide/lab'\r\n\r\ninterface WineTableBodyProps {\r\n  wines: Wine[]\r\n}\r\n\r\nexport function WineTableBody({ wines }: WineTableBodyProps) {\r\n  return (\r\n    <div className=\"bg-white rounded-2xl shadow-xl overflow-hidden border border-red-100\">\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"w-full\">\r\n          <thead className=\"bg-primary text-white\">\r\n            <tr>\r\n              <th className=\"sticky bg-primary left-0 z-30 px-6 py-6 text-left text-[10px] font-black uppercase tracking-[0.2em] border-r border-white/5 w-80 min-w-72 max-w-96\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <WineIcon size={16} />\r\n                  Vino\r\n                </div>\r\n              </th>\r\n\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Icon size={16} iconNode={wineGlassBottle} />\r\n                  Stock\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <DollarSign size={16} />\r\n                  Precio\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Clock size={16} />\r\n                  Tiempo\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <Percent size={16} />\r\n                  Alcohol\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <Palette size={16} />\r\n                  Color\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <Grape size={16} />\r\n                  Variedades\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap w-56 min-w-56\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <MapPin size={16} />\r\n                  Bodega\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap w-auto min-w-56\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <StickyNote size={16} />\r\n                  Notas de Cata\r\n                </div>\r\n              </th>\r\n              <th className=\"px-6 py-4 text-center text-sm font-semibold uppercase tracking-wider whitespace-nowrap\">\r\n                <div className=\"flex items-center justify-center gap-2\">\r\n                  <StickyNote size={16} />\r\n                  Capacidad\r\n                </div>\r\n              </th>\r\n\r\n              <th className=\"sticky bg-primary right-0 z-30 px-6 py-6 text-center text-[10px] font-black uppercase tracking-[0.2em] border-l border-white/5 w-32 min-w-32 max-w-32\">\r\n                Acciones\r\n              </th>\r\n            </tr>\r\n          </thead>\r\n\r\n          <tbody className=\"divide-y divide-gray-100\">\r\n            {wines.map((wine, index) => (\r\n              <WineRow key={wine.id_vino} wine={wine} index={index} />\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n",
            "WineTableHeader.tsx": "import { Download, Upload, Wine as WineIcon, Plus } from \"lucide-react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\n\r\ninterface WineTableHeaderProps {\r\n  onExport: () => void\r\n  onImport: (e: React.ChangeEvent<HTMLInputElement>) => void\r\n  inputRef: React.RefObject<HTMLInputElement>\r\n}\r\n\r\nexport function WineTableHeader({ onExport, onImport, inputRef }: WineTableHeaderProps) {\r\n  return (\r\n    <div className=\"flex items-center justify-between flex-wrap gap-4 p-6 pt-0\">\r\n      <div className=\"flex items-center gap-4\">\r\n        <div className=\"bg-primary/5 p-3 rounded-2xl border border-primary/10\">\r\n          <WineIcon className=\"h-6 w-6 text-primary\" />\r\n        </div>\r\n        <div>\r\n          <h2 className=\"text-3xl font-black text-primary tracking-tight\">\r\n            Administración de Vinos\r\n          </h2>\r\n          <div className=\"flex items-center gap-2 mt-1\">\r\n            <div className=\"size-2 rounded-full bg-green-500 animate-pulse\"></div>\r\n            <span className=\"text-[10px] uppercase tracking-widest font-black text-primary/40\">\r\n              Sincronizado en tiempo real\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex gap-3 flex-wrap\">\r\n        <Button className=\"flex items-center gap-2 bg-green-600 hover:bg-green-600/90 text-white px-6 h-12 rounded-xl font-bold transition-all shadow-lg shadow-green-600/10 transform hover:-translate-y-0.5 text-xs uppercase tracking-widest\">\r\n          <Plus className=\"h-4 w-4\" />\r\n          Agregar Vino\r\n        </Button>\r\n\r\n        <Button\r\n          onClick={onExport}\r\n          className=\"flex items-center gap-2 bg-primary hover:bg-primary/90 text-white px-6 h-12 rounded-xl font-bold transition-all shadow-lg shadow-primary/10 transform hover:-translate-y-0.5 text-xs uppercase tracking-widest\"\r\n        >\r\n          <Download className=\"h-4 w-4\" />\r\n          Exportar Excel\r\n        </Button>\r\n\r\n        <label className=\"flex items-center gap-2 bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-xl font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 cursor-pointer text-sm\">\r\n          <Upload className=\"h-4 w-4\" />\r\n          Importar Excel\r\n          <Input\r\n            ref={inputRef}\r\n            type=\"file\"\r\n            accept=\".xlsx,.xls\"\r\n            onChange={onImport}\r\n            className=\"hidden\"\r\n          />\r\n        </label>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"
          },
          "hooks": {
            "useWineExcel.ts": "import { useRef } from \"react\"\r\nimport * as XLSX from \"xlsx\"\r\nimport { Wine } from \"@/types\"\r\nimport { toast } from \"sonner\"\r\nimport { mapWinesToExcel, mapExcelToWines } from \"../utils/excelMappers\"\r\n\r\nexport function useWineExcel(wines: Wine[], onWinesChange?: (wines: Wine[]) => void) {\r\n  const inputRef = useRef<HTMLInputElement>(null)\r\n\r\n  const exportToExcel = () => {\r\n    try {\r\n      const flatData = mapWinesToExcel(wines)\r\n      const ws = XLSX.utils.json_to_sheet(flatData)\r\n\r\n      // Get data range\r\n      const range = XLSX.utils.decode_range(ws[\"!ref\"] || \"A1\")\r\n\r\n      // Configure protection for all cells (initially unlocked)\r\n      for (let row = range.s.r; row <= range.e.r; row++) {\r\n        for (let col = range.s.c; col <= range.e.c; col++) {\r\n          const cellAddress = XLSX.utils.encode_cell({ r: row, c: col })\r\n          if (!ws[cellAddress]) continue\r\n\r\n          // Unlock all cells by default\r\n          if (!ws[cellAddress].s) ws[cellAddress].s = {}\r\n          ws[cellAddress].s.protection = { locked: false }\r\n        }\r\n      }\r\n\r\n      // Lock specifically the \"id vino\" (column A) and \"id detalle\" (column L) columns\r\n      const protectedColumns = [0, 11] // Column A (id vino) and column L (id detalle)\r\n\r\n      for (let row = range.s.r; row <= range.e.r; row++) {\r\n        protectedColumns.forEach((col) => {\r\n          const cellAddress = XLSX.utils.encode_cell({ r: row, c: col })\r\n          if (ws[cellAddress]) {\r\n            if (!ws[cellAddress].s) ws[cellAddress].s = {}\r\n            ws[cellAddress].s.protection = { locked: true }\r\n\r\n            // Add background color to indicate it's locked\r\n            ws[cellAddress].s.fill = {\r\n              fgColor: { rgb: \"FFE6E6\" },\r\n              bgColor: { rgb: \"FFE6E6\" },\r\n            }\r\n          }\r\n        })\r\n      }\r\n\r\n      // Configure worksheet protection\r\n      ws[\"!protect\"] = {\r\n        password: \"admin123\",\r\n        selectLockedCells: true,\r\n        selectUnlockedCells: true,\r\n        formatCells: false,\r\n        formatColumns: false,\r\n        formatRows: false,\r\n        insertColumns: false,\r\n        insertRows: false,\r\n        insertHyperlinks: false,\r\n        deleteColumns: false,\r\n        deleteRows: false,\r\n        sort: false,\r\n        autoFilter: false,\r\n        pivotTables: false,\r\n      }\r\n\r\n      const wb = XLSX.utils.book_new()\r\n      XLSX.utils.book_append_sheet(wb, ws, \"Vinos\")\r\n      XLSX.writeFile(wb, \"inventario_vinos.xlsx\")\r\n\r\n      toast.success(\"Inventario exportado exitosamente\", {\r\n        description: \"Las columnas ID están protegidas contra edición\",\r\n        action: {\r\n          label: \"cerrar\",\r\n          onClick: () => \"\",\r\n        },\r\n      })\r\n    } catch (error) {\r\n      toast.error(\"Error al exportar el inventario\", {\r\n        description: \"Por favor, intenta nuevamente más tarde.\",\r\n        action: {\r\n          label: \"cerrar\",\r\n          onClick: () => \"\",\r\n        },\r\n      })\r\n    }\r\n  }\r\n\r\n  const handleImport = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0]\r\n    if (!file) return\r\n\r\n    try {\r\n      const data = await file.arrayBuffer()\r\n      const workbook = XLSX.read(data, { type: \"array\" })\r\n      const sheet = workbook.Sheets[workbook.SheetNames[0]]\r\n      const json = XLSX.utils.sheet_to_json<any>(sheet)\r\n\r\n      const imported = mapExcelToWines(json)\r\n\r\n      const errores = imported.filter(\r\n        (w) =>\r\n          !w.nombre ||\r\n          typeof w.stock !== \"number\" ||\r\n          typeof w.precio !== \"number\" ||\r\n          typeof w.nivel_alcohol !== \"number\" ||\r\n          isNaN(w.stock) ||\r\n          isNaN(w.precio) ||\r\n          isNaN(w.nivel_alcohol),\r\n      )\r\n\r\n      if (errores.length > 0) {\r\n        toast.error(\"Error al importar el inventario\", {\r\n          description: \"Error en el archivo: verifica que los campos numéricos sean correctos.\",\r\n          action: {\r\n            label: \"cerrar\",\r\n            onClick: () => \"\"\r\n          },\r\n        })\r\n        return\r\n      }\r\n\r\n      if (onWinesChange) {\r\n        onWinesChange(imported)\r\n      }\r\n\r\n      toast.success(\"Inventario\", {\r\n        description: `${imported.length} vinos importados exitosamente`,\r\n        action: {\r\n          label: \"cerrar\",\r\n          onClick: () => \"\"\r\n        },\r\n      })\r\n\r\n      // Reset file input\r\n      if (inputRef.current) {\r\n        inputRef.current.value = \"\"\r\n      }\r\n    } catch (error) {\r\n      toast.error(\"Error al importar el inventario\", {\r\n        description: \"Error al procesar el archivo Excel.\",\r\n        action: {\r\n          label: \"cerrar\",\r\n          onClick: () => \"\"\r\n        },\r\n      })\r\n    }\r\n  }\r\n\r\n  return {\r\n    inputRef,\r\n    exportToExcel,\r\n    handleImport,\r\n  }\r\n}\r\n",
            "useWinePagination.ts": "import { useState, useEffect } from \"react\"\r\n\r\ninterface UseWinePaginationProps {\r\n  totalItems: number\r\n  itemsPerPage?: number\r\n}\r\n\r\nexport function useWinePagination({ totalItems, itemsPerPage = 10 }: UseWinePaginationProps) {\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n  \r\n  const totalPages = Math.ceil(totalItems / itemsPerPage)\r\n  const startIndex = (currentPage - 1) * itemsPerPage\r\n  const endIndex = startIndex + itemsPerPage\r\n\r\n  // Reset to first page when total items change\r\n  useEffect(() => {\r\n    if (currentPage > totalPages && totalPages > 0) {\r\n      setCurrentPage(1)\r\n    }\r\n  }, [totalItems, currentPage, totalPages])\r\n\r\n  const goToPage = (page: number) => {\r\n    if (page >= 1 && page <= totalPages) {\r\n      setCurrentPage(page)\r\n    }\r\n  }\r\n\r\n  const nextPage = () => {\r\n    if (currentPage < totalPages) {\r\n      setCurrentPage(currentPage + 1)\r\n    }\r\n  }\r\n\r\n  const prevPage = () => {\r\n    if (currentPage > 1) {\r\n      setCurrentPage(currentPage - 1)\r\n    }\r\n  }\r\n\r\n  const getPageNumbers = () => {\r\n    const pages: (number | 'ellipsis')[] = []\r\n    const maxVisiblePages = 5\r\n\r\n    if (totalPages <= maxVisiblePages) {\r\n      for (let i = 1; i <= totalPages; i++) {\r\n        pages.push(i)\r\n      }\r\n    } else {\r\n      if (currentPage <= 3) {\r\n        for (let i = 1; i <= 4; i++) {\r\n          pages.push(i)\r\n        }\r\n        pages.push('ellipsis')\r\n        pages.push(totalPages)\r\n      } else if (currentPage >= totalPages - 2) {\r\n        pages.push(1)\r\n        pages.push('ellipsis')\r\n        for (let i = totalPages - 3; i <= totalPages; i++) {\r\n          pages.push(i)\r\n        }\r\n      } else {\r\n        pages.push(1)\r\n        pages.push('ellipsis')\r\n        for (let i = currentPage - 1; i <= currentPage + 1; i++) {\r\n          pages.push(i)\r\n        }\r\n        pages.push('ellipsis')\r\n        pages.push(totalPages)\r\n      }\r\n    }\r\n\r\n    return pages\r\n  }\r\n\r\n  return {\r\n    currentPage,\r\n    totalPages,\r\n    startIndex,\r\n    endIndex,\r\n    goToPage,\r\n    nextPage,\r\n    prevPage,\r\n    getPageNumbers,\r\n    hasNextPage: currentPage < totalPages,\r\n    hasPrevPage: currentPage > 1,\r\n  }\r\n}\r\n",
            "useWineSearch.ts": "import { useState, useMemo } from \"react\"\r\nimport { Wine } from \"@/types\"\r\n\r\nexport function useWineSearch(wines: Wine[]) {\r\n  const [searchTerm, setSearchTerm] = useState(\"\")\r\n\r\n  const filteredWines = useMemo(() => {\r\n    if (!searchTerm.trim()) return wines\r\n    \r\n    const lowerSearch = searchTerm.toLowerCase()\r\n    return wines.filter((wine) =>\r\n      wine.nombre.toLowerCase().includes(lowerSearch)\r\n    )\r\n  }, [wines, searchTerm])\r\n\r\n  const clearSearch = () => setSearchTerm(\"\")\r\n\r\n  return {\r\n    searchTerm,\r\n    setSearchTerm,\r\n    clearSearch,\r\n    filteredWines,\r\n    hasSearch: searchTerm.trim().length > 0,\r\n  }\r\n}\r\n"
          },
          "index.ts": "export { WineTable } from \"./WineTable\"",
          "utils": {
            "excelMappers.ts": "import { Wine } from \"@/types\"\r\n\r\nexport function mapWinesToExcel(wines: Wine[]) {\r\n  return wines.map((w) => ({\r\n    \"id vino\": w.id_vino,\r\n    stock: w.stock,\r\n    nombre: w.nombre,\r\n    precio: w.precio,\r\n    descripcion: w.descripcion,\r\n    \"nivel alcohol\": w.nivel_alcohol,\r\n    variedades: w.variedades.join(\", \"),\r\n    \"pais importacion\": w.pais_importacion,\r\n    \"color vino\": w.color_vino,\r\n    bodega: w.wine_details.bodega,\r\n    \"id detalle\": w.wine_details.id_detalle,\r\n    \"notas cata\": w.wine_details.notas_cata,\r\n    \"tipo crianza\": w.wine_details.tipo_crianza\r\n  }))\r\n}\r\n\r\nexport function mapExcelToWines(json: any[]): Wine[] {\r\n  return json.map((row: any) => ({\r\n    id_vino: row[\"id vino\"] || row.id_vino || `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n    stock: Number(row.stock) || 0,\r\n    nombre: row.nombre,\r\n    precio: Number(row.precio),\r\n    descripcion: row.descripcion,\r\n    nivel_alcohol: Number(row[\"nivel alcohol\"] || row.nivel_alcohol),\r\n    variedades: row.variedades?.split(\",\").map((v: string) => v.trim()) ?? [],\r\n    pais_importacion: row[\"pais importacion\"] || row.pais_importacion,\r\n    color_vino: row[\"color vino\"] || row.color_vino,\r\n    anada: Number(row.anada),\r\n    url_imagen: row.url_imagen || \"\",\r\n    capacidad: Number(row.capacidad) || 0,\r\n    wine_details: {\r\n      bodega: row.bodega,\r\n      id_vino: row[\"id vino\"] || row.id_vino || `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      id_detalle: row[\"id detalle\"] || row.id_detalle || `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\r\n      notas_cata: row[\"notas cata\"] || row.notas_cata,\r\n      tipo_crianza: row[\"tipo crianza\"] || row.tipo_crianza\r\n    },\r\n  }))\r\n}\r\n",
            "formatPrice.ts": "export function formatPrice(price: number): string {\r\n  return new Intl.NumberFormat(\"es-CO\", {\r\n    style: \"currency\",\r\n    currency: \"COP\",\r\n    minimumFractionDigits: 0,\r\n  }).format(price)\r\n}\r\n",
            "getColorBadge.ts": "export function getColorBadge(color: string): string {\r\n  const colorClasses = {\r\n    Tinto: \"bg-red-100 text-red-800 border-red-200\",\r\n    Blanco: \"bg-amber-100 text-amber-800 border-amber-200\",\r\n    Rosé: \"bg-pink-100 text-pink-800 border-pink-200\",\r\n    Espumoso: \"bg-blue-100 text-blue-800 border-blue-200\",\r\n  }\r\n\r\n  return colorClasses[color as keyof typeof colorClasses] || \"bg-gray-100 text-gray-800 border-gray-200\"\r\n}\r\n"
          },
          "WineTable.tsx": "\"use client\"\r\n\r\nimport { Wine } from \"@/types\"\r\nimport { useWineSearch } from \"./hooks/useWineSearch\"\r\nimport { useWinePagination } from \"./hooks/useWinePagination\"\r\nimport { useWineExcel } from \"./hooks/useWineExcel\"\r\nimport { WineTableHeader } from \"./components/WineTableHeader\"\r\nimport { WineSearch } from \"./components/WineSearch\"\r\nimport { WineTableBody } from \"./components/WineTableBody\"\r\nimport { WinePagination } from \"./components/WinePagination\"\r\nimport { EmptyState } from \"./components/EmptyState\"\r\nimport { RefObject } from \"react\"\r\n\r\ninterface WineTableProps {\r\n  wines?: Wine[]\r\n  onWinesChange?: (wines: Wine[]) => void\r\n  className?: string\r\n}\r\n\r\nexport function WineTable({ wines = [], onWinesChange, className }: WineTableProps) {\r\n  // Search functionality\r\n  const {\r\n    searchTerm,\r\n    setSearchTerm,\r\n    clearSearch,\r\n    filteredWines\r\n  } = useWineSearch(wines)\r\n\r\n  // Pagination functionality\r\n  const {\r\n    currentPage,\r\n    totalPages,\r\n    startIndex,\r\n    endIndex,\r\n    goToPage,\r\n    nextPage,\r\n    prevPage,\r\n    getPageNumbers,\r\n    hasNextPage,\r\n    hasPrevPage,\r\n  } = useWinePagination({\r\n    totalItems: filteredWines.length,\r\n    itemsPerPage: 10\r\n  })\r\n\r\n  // Excel import/export functionality\r\n  const { inputRef, exportToExcel, handleImport } = useWineExcel(wines, onWinesChange)\r\n\r\n  // Get current page wines\r\n  const currentWines = filteredWines.slice(startIndex, endIndex)\r\n  const pageNumbers = getPageNumbers()\r\n\r\n  return (\r\n    <div className={`relative ${className}`}>\r\n      {/* Header with controls */}\r\n      <WineTableHeader\r\n        onExport={exportToExcel}\r\n        onImport={handleImport}\r\n        inputRef={inputRef as RefObject<HTMLInputElement>}\r\n      />\r\n\r\n      {/* Search Bar */}\r\n      <WineSearch\r\n        searchTerm={searchTerm}\r\n        onSearchChange={setSearchTerm}\r\n        onClear={clearSearch}\r\n        totalWines={wines.length}\r\n        filteredCount={filteredWines.length}\r\n      />\r\n\r\n      {/* Table */}\r\n      {currentWines.length > 0 ? (\r\n        <>\r\n          <WineTableBody wines={currentWines} />\r\n\r\n          {/* Pagination */}\r\n          <WinePagination\r\n            currentPage={currentPage}\r\n            totalPages={totalPages}\r\n            startIndex={startIndex}\r\n            endIndex={endIndex}\r\n            totalItems={filteredWines.length}\r\n            pageNumbers={pageNumbers}\r\n            onPageChange={goToPage}\r\n            onNext={nextPage}\r\n            onPrev={prevPage}\r\n            hasNextPage={hasNextPage}\r\n            hasPrevPage={hasPrevPage}\r\n          />\r\n        </>\r\n      ) : (\r\n        <EmptyState searchTerm={searchTerm} totalWines={wines.length} />\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n"
        }
      }
    }
  }
}